\section{Quantum search algorithms}
(Nielsen and Chuang: section 6)\\

\noindent
Classical search through N unordered elements: O(N) \\
Quantum Groover's algorithm: O($\sqrt{N}$) (under certain preconditions)

\subsection{Quantum oracles}
Search space of $N = 2^n$ elements, labelled 0, 1, $\hdots$, N-1. \\
Assume there are M solutions (with $1 \le M \le N$) \\
Define the corresponding \underline{indicator function} \(f: {0, \hdots, N-1} \rightarrow {0,1}\)
\[
    f(x) = \begin{cases}
        0, & \text{if element x is \underline{not} a solution} \\
        1, & \text{if element x \underline{is} a solition}
    \end{cases}
\]

\noindent
Quantum version of f? \\
$\leadsto$ quantum "oracle" $U_f$ defined for computational basic states

\begin{quantikz}
    \lstick{$\ket{x}$} & \qwbundle{n} & \gate[2]{U_f} && \rstick{$\ket{x}$( \textcolor{gray}{register of n quibits})}\\
    \lstick{$\ket{q}$} &              & \qw           && \rstick{$\ket{q \oplus f(x)}$}
\end{quantikz}

\noindent
Notes: \\
With \(x = x_{n-1} \hdots x_1 x_0 \Rightarrow \ket{x} = \ket{x_{n-1}} \hdots \ket{x_1} \ket{x_0}\).\\
$U_f$ maps basis states to basis states and satisfies $U_f^2 = I ( q \oplus f(x) \oplus f(x) = q)$ \\
Thus $U_f$ permites basis states and is in particular unitary.\\

\noindent
Initialize the oracle in superpositions $\ket{-} = \ketX[1][1]{-}$, then
\[\ket{x} \otimes \frac{\ketX{-}}{\sqrt{2}} \xmapsto{U_f} 
            \begin{cases}
                \ket{x} \otimes \frac{\ketX{-}}{\sqrt{2}} \\
                \ket{x} \otimes \frac{\keto - \ketz}{\sqrt{2}} = \textcolor{blue}{-} \ket{x} \otimes \frac{\super[-][][]}{\sqrt{2}}
            \end{cases}
\]
In summary: \(\ket{x} \otimes \frac{\ketX{-}}{\sqrt{2}} \xmapsto{U_f} \textcolor{blue}{(-1)^{f(x)}} \ket{x} \otimes \frac{\ketX{-}}{\sqrt{2}} \mid \text{(oracle qubit unchanged)}\)
Effective action of oracle:
\begin{quantikz}
    \lstick{$\ket{x}$} & \gate{U_f} & \rstick{$(-1)^{f(x)}\ket{x}$}
\end{quantikz}

$\leadsto$ oracle "marks" solutions by a phase flip. \\

\noindent
How could one construct such an oracle without knowing the solution already?\\
Example: factorisation of a large integer \(m \in N\): \\
\indent Finding prime factors of m is "difficult" on a classical computer: \\
\indent (no known algorithm with polynomial runtime in the bitlength of m) \\
But testing whether a given $x \in \mathbb{N}$ divides m is simple. \\
One can perform arithmetic operations for trial division on a digital quantum computer as well $\leadsto$ oracle which recognizes a solution x.
\textcolor{gray}{(Remark: "better" quantum algorithm for integer factorisation: Shor's algorithm.)}


\subsection{Grover's Algorithm}

Search space with $N = 2^n$ element and M solutions; overall circuit diagramm for Grover's algorithm:
(Apply G $O(\sqrt{\frac{N}{M}})$ times.)
\vspace*{10pt}
\begin{figure}[H]
    \begin{center}
        \begin{quantikz}
            \lstick{$\ket{0, \hdots, 0}$} & \qwbundle{n} & \gate{H^{\otimes n}} & \gate[2]{G} & \gate[2]{G} & \ldots & \gate[2]{G} & \meter{} & \setwiretype{c} \\
            \lstick{ow}                   &              &                      &             &             & \ldots &             &        
        \end{quantikz}
    \end{center}

    \captionsetup{
        justification=raggedright, % Aligns text to the left
        singlelinecheck=false      % REQUIRED: prevents centering of short lines
    }

    \caption*{ow: oracle workspace (auxiliary qubit)\\
    G: Groover operator\\}
\end{figure}

\begin{figure}[H]
    \begin{subfigure}[t]{0.4\textwidth}
        \vspace*{0pt}
        \noindent
        \begin{quantikz}[baseline=(current bounding box.center)]
            & \qwbundle{n} & \gate{H^{\otimes n}}
        \end{quantikz} = \begin{quantikz}[baseline=(current bounding box.center)]
            & \gate{H} & \\
            & \gate{H} & \\
            \setwiretype{n} & \vdots & \\
            & \gate{H} & 
        \end{quantikz}
    \end{subfigure}
    \hfill
    \begin{subfigure}[t]{0.5\textwidth}
        \vspace*{0pt}
        \(H = \frac{1}{\sqrt{2}} \colvec{1 & 1 \\ 1 & -1}\)
        \begin{flalign*}
            \text{Note: } & H \ketz = \frac{1}{\sqrt{2}} (\ketX{+}) \\
                          & H \keto = \frac{1}{\sqrt{2}} (\ketX{-})
        \end{flalign*}
        for \(x \in \{0, 1\} \) \\
        \(H \ket{x} = \frac{1}{\sqrt{2}} \sumX_{z = 0}^1 (-1)^{z \cdot x} \ket{z}\)
    \end{subfigure}
\end{figure}

\noindent
Applied to several qubits:
\begin{align*}
    \underbrace{H^{\otimes n}}_{H \otimes H \otimes \hdots H} \ket{x_1, \hdots, x_n} = (H \ket{x_1}) \otimes \hdots \otimes (H \ket{x_n}) 
    &\overset{(1)}{=} \frac{1}{\sqrt{2^n}} \sumX_{z_{1i} - z_n}^1 (-1)^{z_1 x_1 + \hdots + z_n x_n} \ket{z_1 \hdots z_n} \\
    &= \frac{1}{\sqrt{2}} \sumX_{z=0}^{2^n - 1} (-1)^{x \cdot z} \ket{z} \; \; \; \mid \text{z is a bitstring}
\end{align*}

\noindent
With: \\
(1): \(H \ket{x_1} = {\frac{1}{\sqrt{2}} \sumX_{z_1 = 0}^1 (-1)^{z_1 x_1} \ket{z_1}}\) \\

\noindent
In particular: \(H^{\otimes n} \ket{0,\hdots, 0} = \frac{1}{\sqrt{N}} \sumX_{z = 0}^{N - 1} \ket{z} \eqqcolon \textcolor{forest}{\text{\ketp equal superposition state}}\) \\

\newpage\noindent
Definition of Grover operator G: \\

\begin{quantikz}
    \lstick{$\ket{x}$} & \qwbundle{n} & \gate[2]{G} & \\
                       &              &             & 
\end{quantikz} = \begin{quantikz}
    & \gate[2]{U_f} & \gate{H^{\otimes n}} & \gate{ph. \, g.} & \gate{H^{\otimes n}} & \\
    &               & \qw                    & \qw           & \qw                    &
\end{quantikz}

\noindent
Captions: \\
\indent $U_f$ (oracle): \(\ket{x} \mapsto (-1)^{f(x)} \ket{x}\) \\
\indent $ph. \, g.$ (phase gate): \(2 \ketz \braz - I = \begin{cases} \ketz \mapsto \ketz \\ \ket{x} \mapsto - \ket{x} for x \ne 0\end{cases}\) \\

\vspace*{10pt}\noindent
All single qubit gates together:
\begin{flalign*}
    H^{\otimes n} \cdot ( 2 \keto \brao - I ) \cdot H^{\otimes n} 
    &= 2 \underbrace{(H^{\otimes n} \ketz)}_{\textcolor{forest}{\ketp}} \underbrace{(H^{\otimes n} \braz)}_{\textcolor{forest}{\brap}} - I &\\
    &= 2 \textcolor{forest}{\ketp \brap} - I &
\end{flalign*}

\noindent
In summary: \(G = (2\ketp \brap - I) \cdot U_f\) \\

\vspace*{10pt} \noindent
\underline{Geometric interpretation}\\
Define:
\begin{figure}
    \begin{subfigure}{0.4\textwidth}
        \begin{flalign*}
            \ket{\alpha} &\coloneqq \frac{1}{\sqrt{N - M}} \sumX_{\substack{x = 0 \\ f(x) = 0}}^{N - 1} \ket{x} & \\
            \ket{\beta} &\coloneqq \frac{1}{\sqrt{M}} \sumX_{\substack{x = 0 \\ f(x) = 1}}^{N - 1} \ket{x} &
        \end{flalign*}
    \end{subfigure}
    \hfill
    \begin{subfigure}{0.5\textwidth}
        \includegraphics*[width=0.5\textwidth]{assets/GeoInterGrover.png}
    \end{subfigure}
\end{figure}

\noindent
Angle \textcolor{forest}{$\theta$} is defined by \(sin(\frac{\theta}{2}) = \sqrt{\frac{M}{N}}\) such that:
\[\textcolor{forest}{\ketp} = cos(\frac{\theta}{2}) \ket{\alpha} + sin(\frac{\theta}{2} \ket{\beta})\]
Note: by definition \(U_f \ket{\alpha} = \ket{\alpha}, U_f \ket{\beta} = - \ket{\beta}\) \\
$\leadsto \textcolor{purple}{U_f}$ is a \textcolor{purple}{reflection about $\ket{\alpha}$} within the subspace spanned by $\ket{\alpha}$ and $\ket{\beta}$. \\

\noindent
Likewise: \(\textcolor{forest}{2 \ketp \brap - I}\) is a \textcolor{forest}{reflection about \ketp} since \ketp is part of the subspace spanned by $\ket{\alpha}$ and $\ket{\beta}$ G leaves this subspace invariant! \\

\noindent
Thus G is a \textcolor{red}{rotation} by thed angle \textcolor{forest}{$\theta$}: \\
\(\ket{\phi} cos(\varphi) \ket{\alpha} + sin(\varphi) \ket{\beta}\) \\
\(\leadsto G \ket{\phi} = cos(\varphi + \textcolor{forest}{\theta}) \ket{\alpha} + sin(\varphi + \textcolor{forest}{\theta}) \ket{\beta}\) (\textcolor{gray}{see handout for algebraic derivation}) \\

\begin{itemize}[label=]
    \item For k applications of G: \\
        \hspace*{5pt} \(G^k \ket{\phi} = cos(\varphi + k \cdot \theta) \ket{\alpha} + sin(\varphi + k \cdot \theta) \ket{\beta}\)
    \item For initial state \(\ket{\phi} = \textcolor{forest}{\ketp}: \varphi = \frac{\theta}{2}\) \\
        \hspace*{5pt} \(G^k \ket{\varphi} = cos((k + \frac{1}{2}) \theta) \ket{\alpha} + sin(k + \frac{1}{2}) \theta) \ket{\beta}\)
    \item Goal: rotate to $\ket{\beta}$, i.e. \((k + \frac{1}{2} \theta) \overset{!}{=} \frac{\pi}{2}\)\\
        \hspace*{5pt} since \(sin(\frac{\theta}{2}) = \sqrt{\frac{M}{N}} \overset{\text{for M $\ll$ N}}{\rightsquigarrow} \theta \approx 2 \sqrt{\frac{M}{N}}\)
\end{itemize}

\noindent
Thus $O(\sqrt{\frac{N}{M}})$ rotations are needed $\begin{aligned}[t]
    &: k + \frac{1}{2} \overset{!}{=} \frac{\pi}{2\theta}, k \overset{!}{=} \frac{\pi}{2\theta} - \frac{1}{2} \\
    &\leadsto k = O(\sqrt{\frac{N}{M}}) \text{for N} \mapsto \infty
\end{aligned}$

\noindent
Final step: standard measurement, will collapse quantum state (with high probabilitiy) to a basis state forming $\ket{\beta}$, i.e. a solution!

\subsection{Optimality of the search algorithm}
(Nielsen and Chuang section 6.6) \\

\noindent
Goal: show that any quantum search algorithm needs $\Omega(\sqrt{N})$ oracle calls $\leadsto O(\sqrt{N})$ is already optimal. \\

\noindent
For simplicity we assume a single solution x: \\
Recall that oracle flips sign of solutions: \\
\indent \(O_x = I - 2 \ket{x} \bra{x}\) (denoted $U_f$ in the previous section) \\

\noindent
Most general form of algorithm: oracle calls interleaved with unitary operations $U_1, U_2, \hdots$ \\

\noindent
State after k steps: \\
\indent \(\ket{\psi_k^x} = U_k O_x \, U_{k-1} O_x \, \hdots \, U_1 \ket{\psi_0}\) | with $\ket{\psi_0} = $ initial state \\

\noindent
We also define: \\
\indent \(\ket{\psi_k} = U_k U_{k-1} \hdots U_0 \ket{\psi_0}\) \\

\noindent
Strategy of proof: upper bound of 
\[D_k \coloneqq \sumX_{x = 0}^{N - 1} \norm{\ket{\psi_k^x} - \ket{\psi_k}}^2\]
$D_k$ grows as $O(k^2)$, but must be $\Omega(N)$ to distinguish between N alternatives. \textcolor{gray}{(see below)} \\

\noindent \setcounter{equation}{0} 
The following equations and inequalities are going to be used in the proof bellow:
\begin{flalign}
    \text{Unitary Norm: } &\norm{U} = 1 \Rightarrow \norm{U_{k + 1} \ket{x}} = \norm{\ket{x}} \label{eq:unitary_norm} \\
    \text{Spec. Cauchy-Sch.: }&\norm{b + c}^2 = \braket{b + c, b + c} \le \norm{b}^2 + 2 \norm{b} \cdot \norm{c} + \norm{c}^2 \label{eq:special_Cauchy-Schwarz} \\
    \text{Cauchy-Schwarz: } &\sumX_x u_x \cdot v_x \le \norm{u} \cdot \norm{v} \label{eq:Cauchy-Schwarz}
\end{flalign}

\noindent
First show that \(D_k \le 4 k^2\) by induction:
\begin{flalign*}
    k = 0:& \hspace{10pt}   &  D_0 &= 0 &\\
    k \mapsto k + 1:&       &   &       &\\
    &                       &   D_{k + 1} &= \sumX_{x=0}^{N - 1} \big\|\underbrace{U_{k+1} O_x \ket{\psi_k^x} - U_{k+1} \ket{\psi_k}}_{\textcolor{gray}{U_{k + 1} (O_x \ket{\psi_k^x} - \ket{\psi_k})}}\big\|^2             &\\
    &                       &   &\overset{\eqref{eq:unitary_norm}}{=} \sumX_{x=0}^{N - 1} \norm{O_x \ket{\psi_k^x} - \ket{\psi_k}}^2    &\\
    &                       &   &= \sumX_{x=0}^{N - 1} \big\|\underbrace{O_x (\ket{\psi_k^x} - \ket{\psi_k})}_{\eqqcolon b} + \underbrace{(O_x - I) \ket{\psi_k}}_{-2 \ket{x} \Braket{x | \psi_k} \eqqcolon c}\big\|^2      &\\
    &                       &   &\overset{\eqref{eq:special_Cauchy-Schwarz}}{\le} \sumX_{x=0}^{N - 1} (\norm{b}^2 + 2 \norm{b} \cdot \norm{c} + \norm{c}^2) \hspace{25pt}| \; O_x \text{ is unitary}                        &\\
    &                       &   &= \sumX_{x=0}^{N - 1} (\norm{\ket{\psi_k^x} - \ket{\psi_k}}^2 + 4 \norm{\ket{\psi_k^x} - \ket{\psi_k}} \cdot \abs{\Braket{x | \psi_k}} + 4 \abs{\Braket{x | \psi_k}})                    &\\
    &                       &   &\overset{\eqref{eq:Cauchy-Schwarz}}{\le} D_k + 4 \underbrace{(\sumX_{x = 0}^{N - 1} \norm{\ket{\psi_k^x} - \ket{\psi_k}}^2)^{\frac{1}{2}}}_{\textcolor{gray}{\norm{u}}} \cdot \underbrace{(\sumX_{x = 0}^{N - 1} \abs{\braket{x | \psi_k}}^2)^{\frac{1}{2}}}_{\textcolor{gray}{\norm{v} = 1}} + 4   &\\
    &                       &   &= D_k + 4 \sqrt{D_k} + 4   &\\
    &                       &   &\overset{\mathrlap{\kern-0.5em I.H.}}{\le} 4k^2 + 4 \sqrt{4k^2} + 4   &\\
    &                       &   &= 4(k + 1)^2
\end{flalign*}

\newpage \noindent
Second part of the proof: $D_x$ must be in $\Omega(N)$: \\

\begin{adjustwidth}{2em}{0pt}

    \noindent
    For the next proof step we will need the following equations and inequalities:
    \begin{flalign}
        & Re(z) \le \abs{z} \; \forall z \in \mathbb{C} & \label{eq:Rez}
    \end{flalign}

    \noindent
    To find a solution x, we want that \(\ket{\psi_k^x} \sim \ket{x}\) suppose that \(\abs{\braket{x | \psi_k^x}}^2 \ge \textcolor{blue}{\frac{1}{2}} \; \forall x\). \\
    \indent \textcolor{gray}{(probability of success is at least 50\%)} \\

    \noindent
    w.l.o.g. \(\braket{x | \psi_k^x} = \abs{\braket{x | \psi_k^x}}\) (can multiply $\ket{x}$ by phase factor)
    \begin{flalign*}
        \leadsto \norm{\ket{\psi_k^x} - \ket{x}}^2  &= \norm{\ket{\psi_k^x}}^2 - 2\braket{x | \psi_k^x} +\norm{\ket{x}}^2 &\\
                                                    &= 2 - 2 \underbrace{\braket{x | \psi_k^x}}_{\textcolor{blue}{\le \frac{1}{\sqrt{2}}}} &\\
                                                    &\le 2 - \sqrt{2}
    \end{flalign*}

    \noindent
    Therefore: \\
    \indent \(E_k \coloneqq \sumX_{x=0}^{N-1} \norm{\ket{\psi_k^x} - \ket{x}} \le (2 - \sqrt{2}) \cdot N\) \\

    \noindent
    Define \(F_k \coloneqq \sumX_{x = 0}^{N - 1} \norm{\ket{x} - \ket{\psi_k}}^2\), then
    \begin{flalign*}
        \hspace{15pt} F_k &= \sumX_{x = 0}^{N - 1} ( \norm{\ket{x}} - 2 Re\braket{x | \psi_k} + \norm{\ket{psi_k}}^2) &\\
        &\overset{\eqref{eq:Rez}}{\ge} 2 \cdot N - 2 \sumX_{x = 0}^{N -1} \underbrace{\abs{\braket{x | \psi_k}}}_{\textcolor{gray}{u_x}} \cdot \underbrace{1}_{\textcolor{gray}{v_x}} &\\
        &\overset{\eqref{eq:Cauchy-Schwarz}}{\ge} 2 \cdot N - 2 [(\underbrace{\sumX_x \abs{\braket{x | \psi_k}}^{\frac{1}{2}}}_{\textcolor{gray}{1}})^2 \cdot (\underbrace{\sumX_x 1}_{\textcolor{gray}{N}})^{\frac{1}{2}}] \\
        &= 2 \cdot N - 2 \sqrt{N}
    \end{flalign*}
    \begin{flalign*}
        \hspace{15pt} D_k   &= \sumX_{x = 0}^{N - 1} \norm{(\ket{\psi_k^x} - \textcolor{orange}{\ket{x}}) + (\textcolor{orange}{\ket{x}} - \ket{\psi_k}) }^2 &\\
                            &\ge \sumX_{x = 0}^{N - 1} (\norm{\ket{\psi_k^x} - \ket{x}} - 2 \norm{\ket{\psi_k^x} - \ket{x}} \cdot \norm{\ket{x} - \ket{\psi_k}}^2 + \norm{\ket{x} - \ket{\psi_k}}^2) &\\
                            &= E_k + F_k - 2 \sumX_{x = 0}^{N -1} \underbrace{\norm{\ket{\psi_k^x} - \ket{x}}}_{\textcolor{gray}{\eqqcolon a_x}} \cdot \underbrace{\norm{\ket{x} - \ket{\psi_k}}}_{\textcolor{gray}{\eqqcolon b_x}} &\\
                            &\ge E_k + F_k - 2 \underbrace{\sqrt{E_k}}_{\textcolor{gray}{\norm{a}}} \cdot \underbrace{\sqrt{F_k}}_{\textcolor{gray}{\norm{a}}}  = (\sqrt{F_k} - \sqrt{E_k})^2 &\\
                            &\ge (\sqrt{2N - 2\sqrt{N}} - \sqrt{(2 - \sqrt{2}) N} \; )^2 &\\
                            &= N \cdot (\sqrt{2} - \sqrt{2 - \sqrt{2}})^2 &\\
                            &= N (\sqrt{2 - \frac{2}{\sqrt{N}}} - \sqrt{2 - \sqrt{2}} \; )^2 \hspace*{20pt} | \text{ with } \lim_{N \to \infty} \frac{2}{\sqrt{N}} \to 0 &\\
                            &\cong N \cdot \underbrace{(\sqrt{2} - \sqrt{2 - \sqrt{2}})^2}_{\eqqcolon c \, \approx \, 0.42} &\\
                            &= c \cdot N 
    \end{flalign*}
\end{adjustwidth}

\noindent
In summary: 
\[ \underbrace{D_k \le 4 k^2 \text{ and } D_k \ge cN}_{k \ge \sqrt{\frac{cN}{4}}} \]
with k being the number of oracle evaluations. \\